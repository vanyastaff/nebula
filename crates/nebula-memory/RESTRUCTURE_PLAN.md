# nebula-memory Restructure Plan

## Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹:
1. âŒ ĞĞµÑ‚ Ğ¿Ğ°Ğ¿ĞºĞ¸ `core/` - Ğ½ĞµÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¾Ğ¹ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… ĞºÑ€ĞµĞ¹Ñ‚Ğ¾Ğ²
2. âŒ `error.rs`, `config.rs` Ğ² ĞºĞ¾Ñ€Ğ½Ğµ - Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ² `core/`
3. âŒ `traits/` ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ‚Ñ€ĞµĞ¹Ñ‚Ğ¾Ğ² - Ğ½ÑƒĞ¶Ğ½Ğ¾ Ñ€Ğ°Ğ·Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ½Ğ° core Ğ¸ integration
4. âŒ ĞœĞ½Ğ¾Ğ³Ğ¾ feature-based Ğ¿Ğ°Ğ¿Ğ¾Ğº Ğ² ĞºĞ¾Ñ€Ğ½Ğµ (`arena/`, `pool/`, `cache/`, `budget/`, `lockfree/`)
5. âŒ `monitoring.rs` Ğ² ĞºĞ¾Ñ€Ğ½Ğµ - Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ² integration Ğ¸Ğ»Ğ¸ observability

## Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°:

```
src/
â”œâ”€â”€ core/                           # âœ¨ ĞĞĞ’ĞĞ• - Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ error.rs                   # â¬…ï¸ ĞŸĞµÑ€ĞµĞ½ĞµÑÑ‚Ğ¸ Ğ¸Ğ· src/error.rs
â”‚   â”œâ”€â”€ config.rs                  # â¬…ï¸ ĞŸĞµÑ€ĞµĞ½ĞµÑÑ‚Ğ¸ Ğ¸Ğ· src/config.rs
â”‚   â”œâ”€â”€ traits.rs                  # âœ¨ ĞĞĞ’ĞĞ• - Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ñ€ĞµĞ¹Ñ‚Ñ‹ (MemoryManager, MemoryUsage)
â”‚   â””â”€â”€ types.rs                   # âœ¨ ĞĞĞ’ĞĞ• - ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ¸ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹
â”‚
â”œâ”€â”€ allocator/                      # âœ… Ğ£Ğ–Ğ• Ğ¥ĞĞ ĞĞ¨Ğ Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ˜Ğ ĞĞ’ĞĞĞ
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ traits.rs                  # Allocator trait
â”‚   â”œâ”€â”€ error.rs
â”‚   â”œâ”€â”€ stats.rs
â”‚   â”œâ”€â”€ bump.rs                    # âœ… Production-ready
â”‚   â”œâ”€â”€ pool.rs                    # âœ… Production-ready
â”‚   â”œâ”€â”€ stack.rs                   # âœ… Production-ready with StackConfig
â”‚   â”œâ”€â”€ system.rs                  # âœ… Optimized
â”‚   â”œâ”€â”€ manager.rs
â”‚   â”œâ”€â”€ monitored.rs
â”‚   â””â”€â”€ tracked.rs
â”‚
â”œâ”€â”€ syscalls/                       # âœ… Ğ£Ğ–Ğ• Ğ¡ĞĞ—Ğ”ĞĞĞ
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ info.rs
â”‚   â””â”€â”€ direct.rs
â”‚
â”œâ”€â”€ advanced/                       # âœ¨ ĞĞĞ’ĞĞ• - Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ñ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ñ‹Ñ… Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ arena/                     # â¬…ï¸ ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ· src/arena/
â”‚   â”œâ”€â”€ pool/                      # â¬…ï¸ ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ· src/pool/
â”‚   â”œâ”€â”€ cache/                     # â¬…ï¸ ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ· src/cache/
â”‚   â”œâ”€â”€ budget/                    # â¬…ï¸ ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ· src/budget/
â”‚   â””â”€â”€ lockfree/                  # â¬…ï¸ ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ· src/lockfree/
â”‚
â”œâ”€â”€ integration/                    # âœ¨ ĞĞĞ’ĞĞ• - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ ecosystem
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ traits/                    # â¬…ï¸ Ğ ĞµĞ¾Ñ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ src/traits/
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ lifecycle.rs          # â¬…ï¸ Ğ˜Ğ· src/traits/lifecycle.rs
â”‚   â”‚   â”œâ”€â”€ context.rs            # â¬…ï¸ Ğ˜Ğ· src/traits/context.rs
â”‚   â”‚   â”œâ”€â”€ factory.rs            # â¬…ï¸ Ğ˜Ğ· src/traits/factory.rs
â”‚   â”‚   â”œâ”€â”€ observer.rs           # â¬…ï¸ Ğ˜Ğ· src/traits/observer.rs
â”‚   â”‚   â”œâ”€â”€ isolation.rs          # â¬…ï¸ Ğ˜Ğ· src/traits/isolation.rs
â”‚   â”‚   â””â”€â”€ priority.rs           # â¬…ï¸ Ğ˜Ğ· src/traits/priority.rs
â”‚   â””â”€â”€ monitoring.rs             # â¬…ï¸ ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ· src/monitoring.rs
â”‚
â”œâ”€â”€ utils.rs                        # âœ… ĞÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ°Ğº ĞµÑÑ‚ÑŒ
â”œâ”€â”€ macros.rs                       # âœ… ĞÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ°Ğº ĞµÑÑ‚ÑŒ
â””â”€â”€ lib.rs                          # ğŸ”§ ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ imports

## Ğ£Ğ”ĞĞ›Ğ˜Ğ¢Ğ¬:
âŒ `src/platform/` - ÑƒĞ¶Ğµ deprecated Ğ² Ğ¿Ğ¾Ğ»ÑŒĞ·Ñƒ `syscalls/`
âŒ `src/traits/advanced_lifecycle.rs` - Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ
âŒ `src/compression/` - Ğ½Ğµ core Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
âŒ `src/extensions/` - Ğ½Ğµ core Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
âŒ `src/stats/` - ÑƒĞ¶Ğµ ĞµÑÑ‚ÑŒ `allocator/stats.rs`
âŒ `src/streaming/` - ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ğ¾
```

## ĞŸĞ»Ğ°Ğ½ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸:

### Ğ¤Ğ°Ğ·Ğ° 1: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ core/
1. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `src/core/mod.rs`
2. âœ… ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ `error.rs` Ğ² `core/`
3. âœ… ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ `config.rs` Ğ² `core/`
4. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `core/traits.rs` Ñ Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Ñ‚Ñ€ĞµĞ¹Ñ‚Ğ°Ğ¼Ğ¸
5. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `core/types.rs`

### Ğ¤Ğ°Ğ·Ğ° 2: Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° advanced/
1. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `src/advanced/mod.rs`
2. âœ… ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ feature-based Ğ¼Ğ¾Ğ´ÑƒĞ»Ğ¸ Ğ² `advanced/`

### Ğ¤Ğ°Ğ·Ğ° 3: Ğ ĞµĞ¾Ñ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ integration/
1. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ `src/integration/mod.rs`
2. âœ… ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ `traits/` Ğ² `integration/traits/`
3. âœ… ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ `monitoring.rs` Ğ² `integration/`

### Ğ¤Ğ°Ğ·Ğ° 4: Cleanup
1. âœ… Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ deprecated `platform/`
2. âœ… Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ½ĞµĞ½ÑƒĞ¶Ğ½Ñ‹Ğµ Ğ¿Ğ°Ğ¿ĞºĞ¸
3. âœ… ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `lib.rs`
4. âœ… ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ `prelude`

### Ğ¤Ğ°Ğ·Ğ° 5: Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
1. âœ… ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ README
2. âœ… ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ rustdoc
3. âœ… Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ migration guide

## ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ° Ğ½Ğ¾Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹:

âœ… **Ğ•Ğ´Ğ¸Ğ½Ğ¾Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¸Ğµ** - ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğµ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… ĞºÑ€ĞµĞ¹Ñ‚Ğ¾Ğ² (nebula-value, nebula-resource)
âœ… **Ğ§Ğ¸ÑÑ‚Ğ¾Ñ‚Ğ°** - Ñ‡ĞµÑ‚ĞºĞ¾Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ core/advanced/integration
âœ… **ĞŸĞ¾Ğ½ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ** - Ğ»ĞµĞ³ĞºĞ¾ Ğ½Ğ°Ğ¹Ñ‚Ğ¸ Ğ½ÑƒĞ¶Ğ½ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
âœ… **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ĞµĞ¹
âœ… **Backwards compatibility** - Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ re-exports Ğ´Ğ»Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
